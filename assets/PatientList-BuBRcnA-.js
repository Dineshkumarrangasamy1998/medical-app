import k from"./CommonDialog-DZsHkcTd.js";import{N}from"./NoData-DrnsMlRB.js";import{u as I,a as V,d as w,g as q}from"./patientServices-AhRET8v1.js";import{t as G,v as M,T as F,b as U,c as y}from"./index-Dx4dTy8V.js";import{i as m,h as L,c as j,a as g,b as T}from"./validationRules-BV0FID92.js";import{_ as C,v as o,x as r,y as n,G as S,z as u,J as d,W as c,D as p,a1 as _,M as z,q as f,A as H,f as h,B as x,F as J}from"./_plugin-vue_export-helper-b3T1jOJ5.js";import{p as K}from"./data-XbIIhJAV.js";const R={name:"CreatePatient",mixins:[G],props:{userData:{type:Object,required:!1}},data(){return{patientName:"",patientGender:"",patientAddress:"",patientContact:"",patientEmail:"",patientAlternateContact:"",patientDateOfBirth:"",uuidv4:M(),errors:{patientName:"",patientGender:"",patientAddress:"",patientContact:"",patientEmail:"",patientAlternateContact:"",patientDateOfBirth:""},touched:{patientName:!1,patientGender:!1,patientAddress:!1,patientContact:!1,patientEmail:!1,patientAlternateContact:!1,patientDateOfBirth:!1}}},emits:["patient-added","cancel-form","patient-updated","patient-updated"],computed:{formValid(){return this.checkValid()},isEditMode(){return!!this.userData}},watch:{userData:{immediate:!0,handler(e){console.log("vl",e),e?(this.patientName=e.patientName||"",this.patientGender=e.patientGender||"",this.patientAddress=e.patientAddress||"",this.patientContact=e.patientContact||"",this.patientAlternateContact=e.patientAlternateContact||"",this.patientEmail=e.patientEmail||"",this.patientDateOfBirth=e.patientDateOfBirth||"",Object.keys(this.errors).forEach(t=>this.errors[t]="")):this.resetForm()}}},methods:{baseValidation(){const e={patientName:"",patientGender:"",patientAddress:"",patientContact:"",patientEmail:"",patientAlternateContact:"",patientDateOfBirth:""};return m(this.patientName)?L(this.patientName,2)||(e.patientName="Min 2 characters"):e.patientName="Name required",m(this.patientDateOfBirth)?j(this.patientDateOfBirth)||(e.patientDateOfBirth="Future date invalid"):e.patientDateOfBirth="DOB required",m(this.patientGender)||(e.patientGender="Gender required"),m(this.patientContact)?g(this.patientContact)||(e.patientContact="Must be 10 digits"):e.patientContact="Contact required",m(this.patientAlternateContact)&&!g(this.patientAlternateContact)&&(e.patientAlternateContact="Must be 10 digits"),m(this.patientEmail)?T(this.patientEmail)||(e.patientEmail="Invalid email"):e.patientEmail="Email required",m(this.patientAddress)||(e.patientAddress="Address required"),e},checkValid(){const e=this.baseValidation();return console.log("err",e),Object.values(e).every(t=>t==="")},validateAll(){this.errors=this.baseValidation()},validateField(e){const t=this.baseValidation();this.errors[e]=t[e]||""},onInput(e){this.touched[e]=!0,this.validateField(e)},resetForm(){this.patientName="",this.patientGender="",this.patientAddress="",this.patientContact="",this.patientEmail="",this.patientAlternateContact="",this.patientDateOfBirth="",Object.keys(this.errors).forEach(e=>this.errors[e]=""),Object.keys(this.touched).forEach(e=>this.touched[e]=!1)},submitForm(){if(this.touched=Object.fromEntries(Object.keys(this.touched).map(t=>[t,!0])),this.validateAll(),!this.checkValid())return;const e={patientName:this.patientName.trim(),patientGender:this.patientGender,patientAddress:this.patientAddress.trim(),patientContact:this.patientContact.trim(),patientAlternateContact:this.patientAlternateContact.trim(),patientEmail:this.patientEmail.trim(),patientDateOfBirth:this.patientDateOfBirth};this.isEditMode&&this.userData?(I(this.userData.id,e),this.toastSuccess("Patient updated successfully"),this.$emit("patient-updated"),this.resetForm()):(V(e),this.toastSuccess("Patient added successfully"),this.resetForm(),this.$emit("patient-added"))}}},W={class:"mt-1"},Q={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},X={class:"space-y-1 text-sm"},Y={key:0,class:"text-xs text-red-600"},Z={class:"space-y-1 text-sm"},$=["max"],tt={key:0,class:"text-xs text-red-600"},et={class:"space-y-1 text-sm"},it={key:0,class:"text-xs text-red-600"},nt={class:"space-y-1 text-sm"},at={key:0,class:"text-xs text-red-600"},st={class:"space-y-1 text-sm"},rt={key:0,class:"text-xs text-red-600"},ot={class:"space-y-1 text-sm"},lt={key:0,class:"text-xs text-red-600"},dt={class:"space-y-1 text-sm col-span-2"},pt={key:0,class:"text-xs text-red-600"},ut={class:"flex justify-end items-center gap-1 mt-2"},mt=["disabled"];function ct(e,t,b,D,i,s){return r(),o("div",null,[n("div",W,[n("form",{onSubmit:t[21]||(t[21]=S((...a)=>s.submitForm&&s.submitForm(...a),["prevent"]))},[n("div",Q,[n("div",X,[t[22]||(t[22]=n("label",{for:"patientName",class:"block text-gray-600 required"},"Patient Name",-1)),u(n("input",{type:"text",id:"patientName","onUpdate:modelValue":t[0]||(t[0]=a=>i.patientName=a),onInput:t[1]||(t[1]=a=>s.onInput("patientName")),onBlur:t[2]||(t[2]=a=>s.onInput("patientName")),placeholder:"Dinesh Kumar",class:"w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:""},null,544),[[c,i.patientName]]),i.touched.patientName&&i.errors.patientName?(r(),o("p",Y,p(i.errors.patientName),1)):d("",!0)]),n("div",Z,[t[23]||(t[23]=n("label",{for:"dateofbirth",class:"block text-gray-600 required"},"Date of Birth",-1)),u(n("input",{type:"date",id:"dateofbirth","onUpdate:modelValue":t[3]||(t[3]=a=>i.patientDateOfBirth=a),onInput:t[4]||(t[4]=a=>s.onInput("patientDateOfBirth")),onBlur:t[5]||(t[5]=a=>s.onInput("patientDateOfBirth")),max:new Date().toISOString().split("T")[0],class:"w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:""},null,40,$),[[c,i.patientDateOfBirth]]),i.touched.patientDateOfBirth&&i.errors.patientDateOfBirth?(r(),o("p",tt,p(i.errors.patientDateOfBirth),1)):d("",!0)]),n("div",et,[t[25]||(t[25]=n("label",{for:"gender",class:"block text-gray-600 required"},"Gender",-1)),u(n("select",{id:"gender",class:"w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500","onUpdate:modelValue":t[6]||(t[6]=a=>i.patientGender=a),onChange:t[7]||(t[7]=a=>s.onInput("patientGender"))},[...t[24]||(t[24]=[n("option",{value:"male"},"Male",-1),n("option",{value:"female"},"Female",-1),n("option",{value:"other"},"Other",-1)])],544),[[_,i.patientGender]]),i.touched.patientGender&&i.errors.patientGender?(r(),o("p",it,p(i.errors.patientGender),1)):d("",!0)]),n("div",nt,[t[26]||(t[26]=n("label",{for:"contact",class:"block text-gray-600 required"},"Contact Number",-1)),u(n("input",{type:"tel",id:"contact","onUpdate:modelValue":t[8]||(t[8]=a=>i.patientContact=a),onInput:t[9]||(t[9]=a=>s.onInput("patientContact")),onBlur:t[10]||(t[10]=a=>s.onInput("patientContact")),placeholder:"e.g., +1 555 123 4567",class:"w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:""},null,544),[[c,i.patientContact]]),i.touched.patientContact&&i.errors.patientContact?(r(),o("p",at,p(i.errors.patientContact),1)):d("",!0)]),n("div",st,[t[27]||(t[27]=n("label",{for:"alternateContact",class:"block text-gray-600"},"Alternate Contact",-1)),u(n("input",{type:"tel",id:"alternateContact","onUpdate:modelValue":t[11]||(t[11]=a=>i.patientAlternateContact=a),onInput:t[12]||(t[12]=a=>s.onInput("patientAlternateContact")),onBlur:t[13]||(t[13]=a=>s.onInput("patientAlternateContact")),placeholder:"Optional alternate number",class:"w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500"},null,544),[[c,i.patientAlternateContact]]),i.touched.patientAlternateContact&&i.errors.patientAlternateContact?(r(),o("p",rt,p(i.errors.patientAlternateContact),1)):d("",!0)]),n("div",ot,[t[28]||(t[28]=n("label",{for:"email",class:"block text-gray-600 required"},"Email",-1)),u(n("input",{type:"email",id:"email","onUpdate:modelValue":t[14]||(t[14]=a=>i.patientEmail=a),onInput:t[15]||(t[15]=a=>s.onInput("patientEmail")),onBlur:t[16]||(t[16]=a=>s.onInput("patientEmail")),placeholder:"dinesh@gmail.com",class:"w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:""},null,544),[[c,i.patientEmail]]),i.touched.patientEmail&&i.errors.patientEmail?(r(),o("p",lt,p(i.errors.patientEmail),1)):d("",!0)]),n("div",dt,[t[29]||(t[29]=n("label",{for:"address",class:"block text-gray-600 required"},"Address",-1)),u(n("textarea",{id:"address","onUpdate:modelValue":t[17]||(t[17]=a=>i.patientAddress=a),onInput:t[18]||(t[18]=a=>s.onInput("patientAddress")),onBlur:t[19]||(t[19]=a=>s.onInput("patientAddress")),placeholder:"Street, City, State",class:"w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500 input",required:""},null,544),[[c,i.patientAddress]]),i.touched.patientAddress&&i.errors.patientAddress?(r(),o("p",pt,p(i.errors.patientAddress),1)):d("",!0)])]),n("div",ut,[n("button",{type:"button",class:"mr-4 px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",onClick:t[20]||(t[20]=a=>e.$emit("cancel-form"))}," Cancel "),n("button",{type:"submit",disabled:!s.formValid,class:z(["px-4 py-2 rounded-md text-white",s.formValid?"bg-blue-600 hover:bg-blue-700":"bg-blue-300 cursor-not-allowed"])},p(s.isEditMode?"Update":"Submit"),11,mt)])],32)])])}const ft=C(R,[["render",ct]]),ht={name:"PatientList",data(){return{patientsList:[],headers:K,searchValue:"",isDialogOpen:!1,selectedPatient:void 0}},computed:{filteredPatients(){const e=this.searchValue.trim().toLowerCase();return e?this.patientsList.filter(t=>[t.patientName,t.patientEmail,t.patientContact,t.patientDateOfBirth,t.patientGender].some(b=>(b||"").toLowerCase().includes(e))):this.patientsList}},mounted(){this.getPatientsDetails()},components:{NoData:N,CommonDialog:k,CreatePatient:ft,EditIcon:U,TrashIcon:F},methods:{closeDialog(){this.isDialogOpen=!1,this.selectedPatient=void 0,this.getPatientsDetails()},getPatientsDetails(){this.patientsList=q()},editPatient(e){this.selectedPatient=e,this.isDialogOpen=!0},deletePatient(e){y(e.createdBy)&&confirm("Delete this patient?")&&(w(e.id),this.selectedPatient=void 0,this.getPatientsDetails())},canModify(e){return y(e)},onPatientUpdated(){this.selectedPatient=void 0,this.getPatientsDetails(),this.closeDialog()}}},bt={class:"flex justify-between items-center flex-wrap"},yt={class:"justify-end flex mb-4 items-end gap-4"},gt=["onClick"],xt=["onClick"],Ct={key:1,class:""};function Dt(e,t,b,D,i,s){const a=f("EditIcon"),v=f("TrashIcon"),A=f("EasyDataTable"),E=f("NoData"),O=f("CreatePatient"),P=f("CommonDialog");return r(),o(J,null,[n("div",bt,[t[6]||(t[6]=n("div",null,[n("h1",{class:"text-3xl font-bold"},"Patient List")],-1)),n("div",yt,[n("div",null,[t[5]||(t[5]=n("span",null,"search value: ",-1)),u(n("input",{type:"text",class:"input","onUpdate:modelValue":t[0]||(t[0]=l=>i.searchValue=l)},null,512),[[c,i.searchValue]])]),n("button",{type:"button",class:"inline-flex items-center rounded bg-blue-600 h-fit px-4 py-2 text-white text-sm hover:bg-blue-700 focus:outline-none focus:ring",onClick:t[1]||(t[1]=l=>i.isDialogOpen=!0)}," Add new ")])]),i.patientsList&&i.patientsList.length?(r(),H(A,{key:0,headers:i.headers,items:s.filteredPatients,alternating:"","rows-per-page":5},{"item-actions":x(l=>[s.canModify(l.createdBy)?(r(),o("button",{key:0,class:"action-btn",onClick:B=>s.editPatient(l),"aria-label":"Edit"},[h(a,{class:"w-4 h-4"})],8,gt)):d("",!0),s.canModify(l.createdBy)?(r(),o("button",{key:1,class:"action-btn danger",onClick:B=>s.deletePatient(l),"aria-label":"Delete"},[h(v,{class:"w-4 h-4"})],8,xt)):d("",!0)]),_:1},8,["headers","items"])):(r(),o("div",Ct,[h(E,{message:"No patients found",description:"Try adjusting your filters."})])),h(P,{modelValue:i.isDialogOpen,"onUpdate:modelValue":t[4]||(t[4]=l=>i.isDialogOpen=l),title:"Patient Details","close-on-esc":!0,"close-on-backdrop":!0},{default:x(()=>[h(O,{"user-data":i.selectedPatient,onCancelForm:t[2]||(t[2]=l=>s.closeDialog()),onPatientAdded:t[3]||(t[3]=l=>s.closeDialog()),onPatientUpdated:s.onPatientUpdated},null,8,["user-data","onPatientUpdated"])]),_:1},8,["modelValue"])],64)}const Nt=C(ht,[["render",Dt],["__scopeId","data-v-34dabea7"]]);export{Nt as default};
