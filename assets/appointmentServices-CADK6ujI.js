import{c as s,i as u,g as f}from"./index-CNe94dDA.js";const c="app:appointments";function m(n){if(!n)return[];try{const t=JSON.parse(n);return Array.isArray(t)?t:[]}catch{return[]}}function a(n){localStorage.setItem(c,JSON.stringify(n))}function i(){return m(localStorage.getItem(c)).map(n=>({...n,createdBy:n.createdBy}))}function l(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():"a_"+Math.random().toString(36).slice(2,11)}function g(n){const t=new Date().toISOString(),r={...n,id:l(),createdAt:t,updatedAt:t,createdBy:f()?.email},o=i();return o.push(r),a(o),r}function I(n,t){const r=i(),o=r.findIndex(p=>p.id===n);if(o===-1)return null;const e=r[o];if(!s(e.createdBy))throw new Error("Not authorized to update appointment");const d={id:e.id,createdAt:e.createdAt,patientId:t.patientId??e.patientId,doctorId:t.doctorId??e.doctorId,appointmentDate:t.appointmentDate??e.appointmentDate,appointmentTime:t.appointmentTime??e.appointmentTime,notes:t.notes??e.notes,reason:t.reason??e.reason,status:u()?t.status??e.status:e.status,updatedAt:new Date().toISOString(),createdBy:e.createdBy};return r[o]=d,a(r),d}function A(n){const t=i(),r=t.findIndex(e=>e.id===n);if(r===-1)return!1;if(!s(t[r].createdBy))throw new Error("Not authorized to delete appointment");const o=t.filter(e=>e.id!==n);return o.length===t.length?!1:(a(o),!0)}export{g as a,A as d,i as g,I as u};
